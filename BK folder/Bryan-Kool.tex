\documentclass{amsart}

\title{Donaldson-Thomas invariants of local elliptic surfaces via the topological vertex}
\author{Jim Bryan and Martijn Kool}
\date{\today}
\address{
Department of Mathematics\\
University of British Columbia \\
Room 121, 1984 Mathematics Road  \\
Vancouver, B.C., Canada V6T 1Z2  
}


%\usepackage{diagrams}
%\usepackage{eepic,epic}

\usepackage{amsmath}
\usepackage{amsmath,amsthm,amsfonts}
\usepackage{times}
\usepackage[all]{xy}
%\usepackage{amstex}
\usepackage[colorinlistoftodos]{todonotes}



%\newtheorem{thm}{Theorem}%[section]
\newtheorem{theorem}{Theorem}%[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}

\newtheorem{def-theorem}[theorem]{Definition-Theorem}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}


\newcommand{\CC} {\mathbb{C}}          % complex numbers
\newcommand{\NN} {\mathbb{N}}		% natural numbers
\newcommand{\RR} {\mathbb{R}}		% real numbers
\newcommand{\ZZ} {\mathbb{Z}}		% integers
\newcommand{\QQ} {\mathbb{Q}}		% rationals
\newcommand{\PP} {\mathbb{P}}
\renewcommand{\AA} {\mathbb{A}}
\newcommand{\LL} {\mathbb{L}}
\newcommand{\FF} {\mathbb{F}}
\renewcommand{\O}{\mathcal{O}}


\newcommand{\rt}[1]{\stackrel{#1\,}{\rightarrow}}
\newcommand{\Rt}[1]{\stackrel{#1\,}{\longrightarrow}}
\newcommand\To{\longrightarrow}
\newcommand\into{\hookrightarrow}
\newcommand\Into{\ensuremath{\lhook\joinrel\relbar\joinrel\rightarrow}}
\newcommand\INTO{\ar@{^{(}->}[r]}
\newcommand\acts{\curvearrowright}


\newcommand{\Hom}{\operatorname{Hom}}
\newcommand{\Ker}{\operatorname{Ker}}
\newcommand{\End}{\operatorname{End}}
\newcommand{\GL}{\operatorname{GL}}
\newcommand{\Tr}{\operatorname{tr}}
\newcommand{\tr}{\operatorname{tr}}
\newcommand{\Coker}{\operatorname{Coker}}
\newcommand{\im}{\operatorname{Im}}
\newcommand{\M}{\overline{\mathcal{M}}}
\newcommand{\smargin}[1]{\marginpar{\tiny{#1}}}
\newcommand{\Sym}{\operatorname{Sym}}
\newcommand{\Coh}{\operatorname{Coh}}
\newcommand{\Hilb}{\operatorname{Hilb}}
\newcommand{\DT}{\operatorname{DT}}
\newcommand{\Var}{\operatorname{Var}}
\newcommand{\supp}{\operatorname{supp}}
\newcommand{\F}{\mathcal{F}}
\newcommand{\G}{\mathcal{G}}

\begin{document}

\begin{abstract}
%Jim's original:

We compute the Donaldson-Thomas invariants of a local elliptic surface
with section. We introduce a new computational technique which is a
mixture of motivic and toric methods. This allows us to write the
partition function for the invariants in terms of the topological
vertex. Utilizing identities for the topological vertex (some
previously known, some new), we derive product formulas for the
partition functions. In the special case where the elliptic surface is
a K3 surface, we get a new proof of the Katz-Klemm-Vafa formula.
\end{abstract}

\maketitle 

%\markboth{???}  {???}
%\renewcommand{\sectionmark}[1]{}


%\tableofcontents
%\pagebreak


\section{Introduction}

\section{Definitions}

Let $p : S \rightarrow B$ be an elliptic surface over a smooth projective curve $B$ of genus $g$. We make two assumptions:
\begin{itemize}
\item $p$ has a section $B \hookrightarrow S$,
\item all singular fibres of $\pi$ are of Kodaira type $I_1$, i.e.~rational nodal fibres. 
\end{itemize}
We denote the classes of the fibre and section by $B, F \in H^2(S,\ZZ)$. Interesting examples are the elliptic surfaces $E(n)$, where $B = \PP^1$ and $S$ has $12n$ nodal fibres. Then $E(1)$ is the rational elliptic surface and $E(2)$ is the elliptic K3 surface.

Let $\beta \in H_2(S)$ be Poincar\'e dual to $B+hF$, where $h \geq 0$. 
%Then
%$$
%\beta^2 = 2h + B^2
%$$
Now let $X = \mathrm{Tot}(K_S)$ be the total space of the canonical bundle over $S$. Then $X$ is a non-compact Calabi-Yau 3-fold. Let
$$
\Hilb^{\beta,n}(X) = \{ Z \subset X \ : \ [Z] = \beta, \ \chi(\O_Z) = n\}
$$
denote the Hilbert scheme of proper subschemes $Z \subset X$ with fixed homology class and holomorphic Euler characteristics. K.~Behrend associates to any $\CC$-scheme of finite type $Y$ a constructible function $\nu : Y \rightarrow \ZZ$ \cite{Beh}. Applied to $\Hilb^{\beta,n}(X)$, the Donaldson-Thomas invariants of $X$ can be defined as\footnote{If $X$ is a compact Calabi-Yau 3-fold, R.P.~Thomas's original definition of DT invariants is by the degree of the virtual cycle of $\Hilb^{\beta,n}(X)$ \cite{Tho}. Behrend showed that this is the same as $e(\Hilb^{\beta,n}(X),\nu)$ \cite{Beh}. The advantage of the definition by means of virtual cycles is that the construction works relative to a base. This implies deformation invariance of the invariants.} 
$$
\DT_{\beta,n}(X) := \int_{\Hilb^{\beta,n}(X)} \nu \ de := \sum_{k \in \ZZ} k \ e(\nu^{-1}(\{k\})),
$$
where $e(\cdot)$ denotes topological Euler characteristic. Many of the key properties of DT invariants are already captured by the more classical Euler characteristic version\footnote{From the point of view of \cite{Joy, Bri}: there are two natural integration maps on the semi-classical Hall-algebra. One corresponds to weighing by the Behrend function and the other to weighing by the ``trivial'' constructible function which is constant equal to 1.}
$$
\widehat{\DT}_{\beta,n}(X) := \int_{\Hilb^{\beta,n}(X)} 1 \ de = e(\Hilb^{\beta,n}(X)).
$$
For brevity, we define
\begin{align*}
\Hilb^{h,n}(X) &:=\Hilb^{B+hF,n}(X), \\
\DT_{\beta,n}(X) &:= \DT_{B+hF,n}(X), \\
\widehat{\DT}_{h,n}(X) &:= \DT_{B+hF,n}(X).
\end{align*}
The generating functions of interest are
\begin{align*}
\DT(X) &:= \sum_{h \geq 0} \DT_h(X) q^h := \sum_{h \geq 0} \sum_{n \in \ZZ} \DT_{h,n}(X) p^n q^h, \\
\widehat{\DT}(X) &:= \sum_{h \geq 0} \widehat{\DT}_h(X) q^h := \sum_{h \geq 0} \sum_{n \in \ZZ} \widehat{\DT}_{h,n}(X) p^n q^h.
\end{align*}

Since we are dealing with generating functions and our calculations involve cut-paste methods on the moduli space, it is useful to introduce the following notation. We define
\begin{align*}
[\Hilb^{h,\bullet}(X)] := \sum_{n \in \ZZ} [\Hilb^{h,n}(X)] p^n,
\end{align*}
which is an element of $K_0(\Var_{\CC})(\!(p)\!)$, i.e.~a Laurent series with coefficients in the Grothendieck group of varieties. We also write $\Hilb^{h,\bullet}(X)$ to denote the union of all $\Hilb^{h,n}(X)$. Therefore $\Hilb^{h,\bullet}(X)$ is a $\CC$-scheme which is locally of finite type.


\section{Reduction to strata with fixed curve class}

\subsection{$\CC^*$-localization} The scaling action of $\CC^*$ on the fibres of $X$ lifts to the moduli space $\Hilb^{h,\bullet}(X)$. Therefore
$$
e(\Hilb^{h,\bullet}(X)) = e(\Hilb^{h,\bullet}(X)^{\CC^*}).
$$
Therefore, we only need to restrict attention to $\Hilb^{h,\bullet}(X)^{\CC^*}$. 

Using the map $\pi : X \rightarrow S$, a quasi-coherent sheaf on $X$ can be viewed as a quasi-coherent sheaf $\F$ on $S$ together with a morphism $\F \otimes K_{S}^{-1} \rightarrow \F$. A $\CC^*$-equivariant structure on $\F$ translates into a $\ZZ$-grading
$$
\pi_* \F = \bigoplus_{i \in \ZZ} \F_i,
$$
such that $\F \otimes K_{S}^{-1} \rightarrow \F$ is graded, i.e.
$$
\F_i \otimes K_{S}^{-1} \longrightarrow \F_{i-1}.
$$
The structure sheaf $\O_X$ corresponds to 
$$
\pi_* \O_X = \bigoplus_{i=0}^{\infty} K_{S}^{-i}.
$$
Therefore a $\CC^*$-fixed morphism $\F \rightarrow \O_X$ corresponds to a graded sheaf $\F$ as above together with maps
\begin{displaymath}
\xymatrix
{
\cdots & \F_1 & \oplus & \F_0 \ar[d] & \oplus & \F_{-1} \ar[d] & \oplus & \F_{-2} \ar[d] & \cdots \\
& & & \O_S & \oplus & K_{S}^{-1} & \oplus & K_{S}^{-2} & \cdots 
}
\end{displaymath}
It is useful to re-define $\G_i := \F_{-i} \otimes K_{S}^{i}$. Then the data of a $\CC^*$-fixed morphism $\F \rightarrow \O_X$ is equivalent to the following data:
\begin{itemize}
\item coherent sheaves $\{\G_i\}_{i \in \ZZ}$ on $S$,
\item morphisms $\{\G_i \rightarrow \G_{i+1}\}_{i \in \ZZ}$,
\item morphisms $\G_i \rightarrow \O_S$ such that the following diagram commutes:
\end{itemize}
\begin{displaymath}
\xymatrix
{
\cdots & \G_{-1} \ar[r] & \G_0 \ar[r] \ar[d] & \G_{-1} \ar[r] \ar[d] & \G_{-2} \ar[r] \ar[d] & \cdots \\
& & \O_S \ar@{=}[r]& \O_S \ar@{=}[r] & \O_S \ar@{=}[r] & \cdots 
}
\end{displaymath}
In the case of interest to us $\G \rightarrow \O_X$ is an ideal sheaf $I_Z \hookrightarrow \O_X$ cutting out $Z \subset X$. In the above language, this means $\G_i = 0$ for $i<0$, the morphisms $\G_i \rightarrow \O_S$ are injective (hence $\G_i = I_{Z_i}$ is an ideal sheaf cutting out $Z_i \subset S$), and the morphisms $\G_i \rightarrow \G_{i+1}$ are injective (hence $I_{Z_i} \subset I_{Z_{i+1}}$, i.e.~$Z_{i} \supset Z_{i+1}$). We conclude:
\begin{lemma}
A closed point $Z$ of $\Hilb^{h,\bullet}(X)^{\CC^*}$ corresponds to a finite nesting of closed subschemes of $S$
$$
Z_{0} \supset Z_{1} \supset \cdots \supset Z_{l},
$$
for some $l \geq 0$, such such that
$$
\sum_{i=0}^{l} [Z_i] = B + hF \in H_2(S).
$$
\end{lemma}

In the above lemma, each $Z_i$ contains a maximal Cohen-Macaulay subcurve $D_i$ such that $Z_i \setminus D_i$ is 0-dimensional. For $i=0$, $D_0$ is the union of the section $B$ and a $\lambda_0$ thickening of some fibre $F \subset S$ (by Corollary \ref{cor: chow(beta) = sym (B)} of the appendix). Next, for all $i \geq 1$, $D_i$ is a $\lambda_i \leq \lambda_{i-1}$ times thickening of the same fibre $F$. We conclude:
\begin{lemma}
To each closed point $Z$ of $\Hilb^{h,\bullet}(X)^{\CC^*}$ corresponds to a 2D partition $\lambda = (\lambda_1 \geq \lambda_2 \geq \cdots \geq \lambda_l)$. The maximal Cohen-Macaulay subcurve of $Z$ is defined by the scheme-theoretic union of the zero section $B$ and a scheme with ideal sheaf
\begin{equation} \label{CMcurve}
\bigoplus_{i=0}^{l} \O_{S}(-\lambda_i F) \otimes K_{S}^{-i},
\end{equation}
for some fibre of $F \subset S$.
\end{lemma}
This leads to the following proposition:
\begin{proposition}
There exists a stratification
$$
\Hilb^{h,\bullet}(X)^{\CC^*} = \coprod_{\lambda \vdash h} \Hilb^{h,\bullet}_{\lambda}(X)^{\CC^*},
$$
where $\Hilb^{h,\bullet}_{\lambda}(X)^{\CC^*}$ is the locally closed subset of subschemes $Z \subset X$ with maximal Cohen-Macaulay curve defined by the scheme-theoretic union of $B$ and a scheme with ideal sheaf of the form \eqref{CMcurve} for some fibre $F \subset S$.
\end{proposition}


\subsection{Stratifying over the base} Denote by $\Sym^h(B)$ the $h$th symmetric product of $B$. Recall that we have projections 
$$
X \stackrel{\pi}{\longrightarrow} S \stackrel{p}{\longrightarrow} B.
$$
A subscheme $Z$ of $ \Hilb^{h,\bullet}(X)^{\CC^*}$ always contains the zero section $B \subset S \subset X$. We can remove it and consider the scheme $\overline{Z \setminus B}$. There exists a morphism\todo{Can/do we want to write this easier?}
\begin{align*}
\pi_{h} : \Hilb^{h,\bullet}(X)^{\CC^*} &\longrightarrow \Sym^h(B), \\
Z &\mapsto \mathrm{supp}( p_* \pi_* \O_{\overline{Z \setminus B}} ),
\end{align*}
where $\supp(\cdot)$ takes the scheme theoretic support, which is a divisor on $B$... 
   

\appendix
\section{Odds and Ends}\label{appendix: odds and ends}


\subsection{Weighted Euler characteristics of symmetric products}

In this section we prove the following formula for the weighted Euler
characteristic of symmetric products.

\begin{lemma}\label{lem: formula for euler char of sym products}
Let $S$ be a scheme of finite type over $\CC $ and let $e (S)$ be its
topological Euler characteristic. Let $g:\ZZ _{\geq 0}\to \ZZ ((Q))$
be any function with $g (0)=1$. Let $f_{d}:\Sym ^{d} (S)\to \ZZ ((Q))$
be the constructible function defined by $f_{d} (\sum_{i}
a_{i}x_{i})=\prod _{i}g (a_{i})$. Then
\[
\sum _{d=0}^{\infty } u^{d} \int _{\Sym ^{d} (S)} f_{d} de =
\left(\sum _{a=0}^{\infty }g (a) u^{a} \right)^{e (S)}.
\]
\end{lemma}

\begin{remark}
In the special case where $g=f_{d}\equiv  1$, the lemma recovers
Macdonald's formula: $\sum _{d=1}^{\infty }e (\Sym ^{d} (S)) u^{d} =
(1-u)^{-e (S)}$. 

The lemma is essentially a consequence of the existence of a power
structure on the Grothendieck group of varieties definited by
symmetric products and the compatibility of the Euler characteristic
homomorphism with that power structure \cite{}. For convenience's
sake, we provide a direct proof here.
\end{remark}
\begin{proof}
The $d$th symmetric product admits a stratification with strata
labelled by partitions of $d$. Associated to any partition of $d$ is a
unique tuple $(m_{1},m_{2},\dots )$ of non-negative integers with
$\sum _{j=1}^{\infty }j m_{j}=d$. The stratum labelled by
$(m_{1},m_{2},\dots )$ parameterizes collections of points where there
are $m_{j}$ points of multiplicity $j$. The full stratification is
given by:
\[
\Sym ^{d} (S) = \bigsqcup_{\begin{smallmatrix} (m_{1},m_{2},\dots )\\
\sum _{j=1}^{\infty }j m_{j}=d  \end{smallmatrix}} \left\{\left(\prod _{j=1}^{\infty }S^{m_{j}} \right) -\Delta  \right\}/ \prod _{j=1}^{\infty }\sigma _{m_{j}} 
\]
where by convention, $S^{0}$ is a point, $\Delta $ is the large
diagonal, and $\sigma _{m}$ is the $m$th symmetric group. Note that
the function $f_{d}$ is constant on each stratum and has value $\prod
_{j=1}^{\infty }g (j)^{m_{j}}$. Note also that the action of $\prod
_{j=1}^{\infty }\sigma _{m_{j}}$ on each stratum is free. 

For schemes over $\CC $, topological Euler characteristic is additive
under stratification and multiplicative under maps which are
(topological) fibrations. Thus
\[
\int _{\Sym ^{d} (S)} f_{d}\,\, de = \sum _{\begin{smallmatrix}(m_{1},m_{2},\dots )\\
\sum _{j=1}^{\infty }j m_{j}=d   \end{smallmatrix}} \left(\prod _{j=1}^{\infty } g (j)^{m_{j}} \right) \frac{e (S^{\sum _{j}m_{j}}-\Delta )}{m_{1}!\, m_{2}!\, m_{3}!\dots }.
\]

For any natural number $N$, the projection $S^{N}-\Delta \to
S^{N-1}-\Delta $ has fibers of the form $S-\{N-1\text{ points}
\}$. The fibers have constant Euler characteristic given by $e (S)-
(N-1)$ and consequently, $e (S^{N}-\Delta )= (e (S)- (N-1))\cdot e
(S^{N-1}-\Delta )$. Thus by induction, we find $e (S^{N}-\Delta ) = e
(S)\cdot (e (S)-1)\cdots (e (S)- (N-1))$ and so 
\[
\frac{e (S^{\sum _{j}m_{j}}-\Delta )}{m_{1}!\,m_{2}!\,m_{3}!\cdots } = \binom{e (S)}{m_{1},m_{2},m_{3},\cdots }
\]
where the right hand side is the generalized multinomial coefficient.

Putting it together and applying the generalized multinomial theorem,
we find
\begin{align*}
\sum _{d=0}^{\infty } \int _{\Sym ^{d} (S)}f_{d}\,\,de & = \sum _{(m_{1},m_{2},\dots )} \prod _{j=1}^{\infty } \left(g (j) u^{j} \right)^{m_{j}} \binom{e (S)}{m_{1},m_{2},m_{3},\dots }\\
&=\left(1+\sum _{j=1}^{\infty }g (j) u^{j} \right)^{e (S)}
\end{align*}
which proves the lemma.   
\end{proof}

\subsection{Some geometry of curves on elliptic surfaces}\label{subsec: geometry of curves on elliptic surfaces}

In this subsection we prove the following lemma and corollary, which will tell us what is the reduced support of all curves in the class $\beta =B+dF$.

\begin{lemma}\label{lem: H0 (pi* (D) (B))=H0 (pi* (D))}
For any line bundle $\epsilon $ on $B$, multiplication by the
canonical section of $\O (B)$ induces an isomorphism
\[
H^{0} (S,\pi ^{*} (\epsilon ) (B)) \cong H^{0} (S,\pi ^{*} (\epsilon )).
\]
\end{lemma}

\begin{corollary} \label{cor: chow(beta) = sym (B)}
Let $\beta = B+dF \in H_{2} (S)$. Then the Chow variety of curves in
the class $\beta $ is isomorphic to $\Sym ^{d} (B)$ where a point
$\sum _{i}d_{i} x_{i}\in \Sym ^{d} (B)$ corresponds to the curve
$B+\sum _{i}d_{i} F_{x_{i}}$.
\end{corollary}

\begin{proof}
The corollary follows immediately from the lemma since the Chow
variety is the space of effective divisors and the lemma implies that
any effective divisor in the class $\beta $ is a union of the section
$B$ with an effective divisor pulled by from the base.

To prove lemma~\ref{lem: H0 (pi* (D) (B))=H0 (pi* (D))} we proceed as
follows. For any line bundle $\delta $ on $B$, the Leray spectral
sequence yields the short exact sequence:
\[
0\to H^{0} (B,\delta \otimes R^{1}\pi _{*}\O )\to H^{1} (S,\pi ^{*}\delta )\Rt{\alpha } H^{1} (B,\delta )\to 0,
\]
in particular, $\alpha $ is a surjection.

Then the long exact cohomology sequence associated to 
\[
0\to \pi ^{*}\delta \otimes \O (-B)\to \pi ^{*}\delta \to \O _{B}\otimes \pi ^{*}\delta \to 0
\]
is
\[
\dotsb \to H^{1} (S,\pi ^{*} (\delta ))\rt{\alpha }H^{1} (B,\delta )\to H^{2} (S,\pi ^{*}\delta \otimes \O (-B))\to H^{2} (S,\pi ^{*}\delta )\to 0,
\]
and since $\alpha $ is a surjection, we get an isomorphism of the last
two terms. We apply Serre duality to that isomorphism and we use the
fact that $K_{S} = \pi ^{*} (K_{B}\otimes L)$ where $L = \left(R\pi
_{*}\O _{S} \right)^{\vee }$ \cite[prop?]{Fr-Mo} to obtain
\[
H^{0} (S,\pi ^{*} (\delta ^{-1}\otimes K_{B}\otimes L) (B)) \cong H^{0}(S,\pi ^{*} (\delta ^{-1}\otimes K_{B}\otimes L)).
\]
Letting $\delta =K_{B}\otimes L\otimes \epsilon ^{-1}$, the lemma is
proved.
\end{proof}


     
\bibliography{mainbiblio}
\bibliographystyle{plain}

\end{document}

